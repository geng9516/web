<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head
        th:replace="layout/header::common_header(title='予定作成',cssPaths='/pages/content.min.css,' + '/pages/workYearSchedule.min.css')">
</head>

<body>
<div th:replace="layout/loadingBar::loadingBar"></div>
<main class="content workyearschedule-warp" @scroll.passive="handleScroll" ref="layout">
    <div class="content_head">
        <div class="header">
            <div class="title1">
                <h1>
                    <Icon type="i-emeer colored"></Icon>
                    {{yyyyMMdd ? `予定作成（${yyyyMMdd})` : '予定作成'}}
                </h1>
            </div>
            <div class="btnbox">
                <span style="flex:1"></span>
                <i-button type="primary" size="large" icon="md-create"  :disabled="!selectDisabled" @click="showWeek = !showWeek">週勤務パターン編集</i-button>
                <i-button type="primary" size="large" icon="md-create"  :disabled="!selectDisabled"  @click="handleChangeWorkPattern();isEditable = !isEditable"  v-if=" !isEditable">対象者一括編集</i-button>
                <i-button type="success" icon="md-create" size="large" v-if=" isEditable" @click="postExecuteEditMonthlyUSchedule">登録</i-button>
                <i-button size="large" v-if=" isEditable" @click="isEditable = !isEditable">キャンセル</i-button>
            </div>
        </div>
        <div class="searchwrap">
            <!-- 共通組織図画面 start-->
            <span style="display:flex;width: calc(15% + 200px);">
                    <span class="label">所属</span>
                    <i-button v-on:click.native="deptDrawShow = true" class="input-like-span mr30 cursor grey"
                              style="width: calc(100% - 120px);border-radius:0">
                        {{ deptName }}
                    </i-button>
                    <Drawer class="tc" title="所属を選択してください" placement="right" width="700" :closable="false"
                                                v-model="deptDrawShow">
                        <div class="titlenorm mt15">
                            <Icon type="logo-buffer"></Icon>
                            所属
                        </div>

                       <Row class="tl mb5">
                            <i-col span="4" class="label tc" style="height: 32px;">基準日</i-col>
                            <i-col span="7" class="no-border-radius">
                            <date-picker type="date" :value="referListObject.txtTmgReferListTreeViewRecordDate"
                                         placeholder="基準日" format="yyyy/MM/dd" ref="datePicker" @on-change="handleDeptDateChange"></date-picker>
                            </i-col>
                        </Row>
                        <Row class="tl mb2" :gutter="8">
                            <i-col span="15">
                                <i-input v-model="referListObject.hidSearchData" @on-search="searchOrgTree" class="mar mb5 like-select" search enter-button placeholder="検索">
                                    <i-select v-model="referListObject.hidSearchItems" slot="prepend" style="width: 108px" placeholder="項目">
                                        <i-option v-for="(item,i) of searchTypesList" :value="item.value">{{ item.name }}</i-option>
                                    </i-select>
                                    <i-select v-model="referListObject.hidSearchCondition"  slot="append" style="width: 108px" placeholder="条件">
                                        <i-option v-for="(item,i) of searchConditionsList" :value="item.value">{{ item.name }}</i-option>
                                    </i-select>
                                </i-input>
                            </i-col>
                            <i-col span="8" class="no-border-radius">
                                <i-button long type="primary" icon="md-search" ghost :loading="empDeptLoading" @click="searchOrgTree">検索</i-button>
                            </i-col>
                        </Row>

                        <Tree class="tree mt2" :data="treeData" @on-select-change="handleClickLeaf" ref="tree"
                              empty-text="所属データなし"></Tree>
                        <div class="titlenorm mt15">
                            <Icon type="logo-buffer"></Icon>
                            社員
                        </div>
                        <div style="position: relative;">
                            <Tree class="tree mt2" :data="empTreeData" @on-select-change="handleClickEmpLeaf" empty-text="社員データなし"></Tree>
                            <Spin size="large" fix v-if="emplistLoading"></Spin>
                        </div>
                    </Drawer>
                <!-- 共通組織図画面 end-->
                </span>
            <span class="label">氏名</span>
            <span class="input-like-span width15">{{ kanjiName }}</span>
        </div>
    </div>
    <div class="content_body">
        <div class="table-top">
            <Row :gutter="16">
                <Col span="11">
                <i-button type="text" @click="preMonth" :disabled="!selectDisabled">
                    <Icon type="ios-arrow-back"></Icon>
                    前月
                </i-button>
                <i-button type="text" @click="nextMonth" :disabled="!selectDisabled">
                    翌月
                    <Icon type="ios-arrow-forward"></Icon>
                </i-button >
                </Col>
            </Row>
        </div>
        <div style="position: relative;">
            <Row :gutter="10" class="mt5 mb15 tc">
                <i-col span="4">
                    <div class="label">公休日数</div>
                    <div class="person-info">{{paidHolidayVO.nationalHolidayDays}}</div>
                </i-col>
                <i-col span="4">
                    <div class>
                        <div class="label">基準日数</div>
                        <div class="person-info">{{paidHolidayVO.dateOfRecordDays}}</div>
                    </div>
                </i-col>
                <i-col span="4">
                    <div class="label">基準時間</div>
                    <div class="person-info">{{paidHolidayVO.dateOfRecord}}</div>
                </i-col>
                <i-col span="4">
                    <div class="label">年次休暇残</div>
                    <div class="person-info">{{paidHolidayVO.npaidRestDaysHour}}</div>
                </i-col>
            </Row>

            <div class="titlenorm mb10 mt15" v-if=" isEditable">
            <Icon type="logo-buffer"></Icon>
            一括適用
        </div>

            <Row v-if=" isEditable" class="mb10">
            <i-col span="3">
                <div class="label">勤務パターン</div>
            </i-col>
            <i-col span="6">
                <i-select class="no-border-radius"  :disabled="!patternDisabled" v-model="workPatternSelected" @on-change="handleChangeWorkPattern()">
                    <i-option v-for="(item, i) of workPatternList" :key="i" :value="item.CPATTERNID">{{ item.CPATTERNNAME }}</i-option>
                </i-select>
            </i-col>
        </Row>

            <i-table :columns="columnsAction" :data="columnsActionData" v-if=" isEditable">
            <template slot-scope="{ row }" slot="workDivision">
                <i-select  transfer v-model="pattern.workId"　@on-change="handleChangeDivision($event)">
                    <i-option v-for="(item, i) of kubunnList" :key="i" :value="item.MGD_CMASTERCODE">{{ item.MGD_CGENERICDETAILDESC }}</i-option>
                </i-select>
            </template>

            <template slot-scope="{ row }" slot="workFar">
                <i-select transfer  v-model="pattern.bussinessTripid">
                    <i-option v-for="(item, i) of syuccyouList" :key="i" :value="item.MGD_CMASTERCODE">{{ item.MGD_CGENERICDETAILDESC }}</i-option>
                </i-select>
            </template>

            <template slot-scope="{ row }" slot="startTime">
                <i-input v-model="pattern.nopen"　:disabled="!patternDisabled" @on-blur="handleInputChange(row._index, pattern,'nopen', $event.target)"/>
            </template>

            <template slot-scope="{ row }" slot="endTime">
                <i-input v-model="pattern.nclose"　:disabled="!patternDisabled" @on-blur="handleInputChange(row._index, pattern,'nclose', $event.target)"/>
            </template>

            <template slot-scope="{ row }" slot="restTime" >
                <Row :gutter="10" v-for="(item, i) of pattern.restList" :key="i" class="mb5" >
                    <i-col :span="pattern.restList.length > 1 ? 8 : 12">
                        <i-input v-model="pattern.restList[i].restOpen"　:disabled="!patternDisabled" @on-blur="handleInputChange(row._index, pattern.restList[i],'restOpen', $event.target)"/>
                    </i-col>
                    <i-col :span="pattern.restList.length > 1 ? 8 : 12">
                        <i-input v-model="pattern.restList[i].restClose"　:disabled="!patternDisabled" @on-blur="handleInputChange(row._index, pattern.restList[i],'restClose', $event.target)"/>
                    </i-col>
                    <i-col span="8" v-show="pattern.restList.length > 1">
                        <i-button ghost type="error" @click="handleMinusRest(pattern.restList, i)">-</i-button>
                    </i-col>
                </Row>
                <i-button
                        :disabled="!patternDisabled"
                        class="mt5"
                        size="small"
                        ghost
                        type="success"
                        long
                        @click="handleAddRest(pattern.restList)"
                        v-show="pattern.restList.length < 4"
                >+</i-button>
            </template>

            <template slot-scope="{ row }" slot="option">
                <i-button type="primary" class="mr5" ghost @click="handleSelectAll2(false)">
                    クリア
                </i-button>
                <i-button type="primary" class="mr5" ghost @click="handleSelectAll2(true)">
                    全選択
                </i-button>
            </template>
                <template slot-scope="{ row }" slot="apply">
                    <i-button type="primary" class="mr5" ghost @click="handleSelectApply">
                        適用
                    </i-button>
                </template>
        </i-table>

            <div class="titlenorm mb10 mt15" v-if=" isEditable">
            <Icon type="logo-buffer"></Icon>
            勤務予定
        </div>

            <i-table :class="tableHeadFixed ? 'table-head-fixed sum-table' : 'sum-table'"  border :columns="columns"
                 :row-class-name="rowClass" :disabled-hover="true" :data="scheduleDataDTOList"
                 ref="selection2"  @on-selection-change="handleSelectAll($event)"
        >

            <template slot-scope="{ row }" slot="intDay">
                <span :class="dayRed(row.tda_nmmday)">{{`${row.tda_nmmdd}　${row.tda_nmmday}`}}</span>
            </template>

            <template slot-scope="{ row }" slot="workDivision">
                <i-select v-model="value[row._index].workId" transfer v-if=" isEditable">
                    <i-option v-for="(item, i) of kubunnList" :key="i" :value="item.MGD_CMASTERCODE">{{ item.MGD_CGENERICDETAILDESC }}</i-option>
                </i-select>

                <span :class="dayRed(row.tda_cworkingid_mm)" v-else>{{ row.tda_cworkingid_mm }}</span>
            </template>

            <template slot-scope="{ row }" slot="workFar">
                <i-select v-model="value[row._index].bussinessTripid" transfer v-if="isEditable">
                    <i-option v-for="(item, i) of syuccyouList" :key="i" :value="item.MGD_CMASTERCODE">{{ item.MGD_CGENERICDETAILDESC }}</i-option>
                </i-select>
                <span  v-else>{{ row.tda_cbusinesstripid_mm }}</span>
            </template>

            <template slot-scope="{ row}" slot="workStartFinal">
                <i-input v-model="value[row._index].nopen" v-if=" isEditable" @on-blur="handleInputChange(row._index, value[row._index],'nopen', $event.target)"></i-input>
                <span v-else>{{ value[row._index].nopen }}</span>
            </template>

            <template slot-scope="{ row }" slot="workEndFinal">
                <i-input v-model="value[row._index].nclose" v-if=" isEditable" @on-blur="handleInputChange(row._index, value[row._index],'nclose', $event.target)"></i-input>
                <span v-else>{{ value[row._index].nclose}}</span>
            </template>

            <template slot-scope="{ row }" slot="restTimeList">
                <div v-if=" isEditable">
                    <Row :gutter="10" v-for="(item, i) of value[row._index].restList" :key="i" class="mb5">
                        <i-col :span="value[row._index].restList.length > 1 ? 8 : 12">
                            <i-input v-model="value[row._index].restList[i].restOpen" @on-blur="handleInputChange(row._index, value[row._index].restList[i],'restOpen', $event.target)"/>
                        </i-col>
                        <i-col :span="value[row._index].restList.length > 1 ? 8 : 12">
                            <i-input v-model="value[row._index].restList[i].restClose" @on-blur="handleInputChange(row._index, value[row._index].restList[i],'restClose', $event.target)"/>
                        </i-col>
                        <i-col span="8" v-show="value[row._index].restList.length > 1">
                            <i-button ghost type="error" @click="handleMinusRest(value[row._index].restList, i)">-</i-button>
                        </i-col>
                    </Row>
                    <i-button
                            class="mt5"
                            size="small"
                            ghost
                            type="success"
                            long
                            @click="handleAddRest(value[row._index].restList);"
                            v-show="value[row._index].restList.length < 4"
                    >+
                    </i-button>

                </div>
                <span v-for="(item,i) of value[row._index].restList" v-else>{{i==0?"":" / "}}{{item.restOpen}}-{{item.restClose}} </span>
            </template>

            <template slot-scope="{ row }" slot="remark">
                <i-input v-model="value[row._index].comment" v-if=" isEditable"></i-input>
                <span v-else>{{ value[row._index].comment }}</span>
            </template>
        </i-table>
            <Spin size="large" fix v-if="loading"></Spin>
        </div>
        <Drawer title="週勤務パターン 編集" width="800" v-model="showWeek" draggable>
            <Row>
                <i-col span="6" class="label">所属</i-col>
                <i-col span="9">
                <span class="input-like-span">{{deptName}}</span>
                </i-col>
            </Row>

            <Row>
                <i-col span="6" class="label">氏名</i-col>
                <i-col span="9">
                <span class="input-like-span">{{kanjiName}}</span>
                </i-col>
            </Row>

            <Row>
                <i-col span="6" class="label">種別</i-col>
                <i-col span="9">
                <span class="input-like-span">{{wokertypename}}</span>
                </i-col>
            </Row>

            <div class="titlenorm mb10 mt15">
                <Icon type="logo-buffer"></Icon>
                適用済
            </div>
            <i-table border class="mt5" :columns="columnsUsed" :data="tableDataUsed">
                <template slot-scope="{ row }" slot="startTime">
                    <i-input v-model="row.twp_dstartdate" disabled ></i-input>
                </template>

                <template slot-scope="{ row }" slot="endTime">
                    <i-input v-model="row.twp_denddate" disabled></i-input>
                </template>

                <template slot-scope="{ row }" slot="content">
                    <i-button type="primary" ghost @click="showWeekHistory = !showWeekHistory;selectWeekPatternInfo(row._index)">参照</i-button>
                </template>

                <template slot-scope="{ row }" slot="action">
                    <i-button type="error" ghost @click="deleteWeekPtn(row._index)">削除</i-button>
                </template>
            </i-table>

            <Alert class="primary-info mt10">
                既に適用中の勤務パターンは、適用終了日の更新のみ可能です。
            </Alert>

            <div class="titlenorm mb10 mt15">
                <Icon type="logo-buffer"></Icon>
                新規
            </div>
            <Row class="mt5">
                <i-col span="6" class="label">適用期間</i-col>
                <i-col span="4">
                    <date-picker type="date"  class="datepicker-single mb5" placeholder="日付け"
                                 format="yyyy/MM/dd" @on-change="value2.applyStart = $event"></date-picker>
                </i-col>
                <i-col span="1">
                <span style="display: inline-block;vertical-align: sub;color:grey;margin-top: 6px">－</span>
                </i-col>
                <i-col span="4">
                    <date-picker type="date"  class="datepicker-single mb5" placeholder="日付け"
                                 format="yyyy/MM/dd" @on-change="value2.applyEnd = $event" ></date-picker>
                </i-col>

                <i-col span="4" offset="5">
                <i-button type="primary" ghost long @click="executeMakeWeekPattern">登録</i-button>
                </i-col>
            </Row>
            <i-table border class="mt5" :columns="columns2" :data="tableData2">
                <template slot-scope="{ row }" slot="workDivision">
                    <i-select v-model="value2.applyList[row._index].workDivisionId" transfer>
                        <i-option v-for="(item) of workDivisionList" :value="item.mgd_work">{{ item.mgd_workname }}</i-option>
                    </i-select>
                </template>

                <template slot-scope="{ row }" slot="startTime">
                    <i-input v-model="value2.applyList[row._index].startTime" @on-blur="handleInputChange(row._index, value2.applyList[row._index],'startTime', $event.target)"></i-input>
                </template>

                <template slot-scope="{ row }" slot="endTime">
                    <i-input v-model="value2.applyList[row._index].endTime" @on-blur="handleInputChange(row._index, value2.applyList[row._index],'endTime', $event.target)"></i-input>
                </template>

                <template slot-scope="{ row }" slot="rest">
                    <Row :gutter="16">
                        <i-col span="12">
                        <i-input v-model="value2.applyList[row._index].restStartTime" @on-blur="handleInputChange(row._index, value2.applyList[row._index],'restStartTime', $event.target)"></i-input>
                        </i-col>
                        <i-col span="12">
                        <i-input v-model="value2.applyList[row._index].restEndTime" @on-blur="handleInputChange(row._index, value2.applyList[row._index],'restEndTime', $event.target)"></i-input>
                        </i-col>
                    </Row>
                </template>
            </i-table>
        </Drawer>

        <div style="position: relative;">
            <Modal v-model="showWeekHistory" width="700" title="週勤務パターン参照" footer-hide draggable>
                <Spin size="large" fix v-if="weekPatternloading"></Spin>
            <Row>
                <i-col span="6" class="label">適用期間</i-col>
                <i-col span="8">
                <span class="input-like-span">{{applyStartTime}}</span>
                </i-col>
                <i-col span="1">
                <span style="display: inline-block;vertical-align: sub;color:grey;margin-top: 6px">－</span>
                </i-col>
                <i-col span="8">
                <span class="input-like-span">{{applyEndTime}}</span>
                </i-col>
            </Row>

            <i-table border class="mt10 mb20" :columns="columns2" :data="tableData3">
                <template slot-scope="{ row }" slot="workDivision">
                    <span>{{ row.workname }}</span>
                </template>

                <template slot-scope="{ row }" slot="startTime">
                    <span>{{ row.twp_copen }}</span>
                </template>

                <template slot-scope="{ row }" slot="endTime">
                    <span>{{ row.twp_cclose }}</span>
                </template>

                <template slot-scope="{ row }" slot="rest">
                    <Row :gutter="16">
                        <i-col span="12">
                        <span>{{ row.rest[0] }}</span>
                        </i-col>
                        <i-col span="12">
                        <span>{{ row.rest[1] }}</span>
                        </i-col>
                    </Row>
                </template>
            </i-table>
            </Modal>

        </div>
    </div>
    <span class="toTopBtn" @click="toTop" v-show="isScroll">
            <Icon size="24" type="md-arrow-round-up" />
    </span>
</main>
<div th:replace="layout/script::common_script"></div>
<script type="text/babel" th:inline="javascript">
    const WORK_YEAR_SCHEDULE = new Vue({
        el: '.workyearschedule-warp',
        data() {
            return {
                weekPatternloading:false,
                valuebak:[],
                patternDisabled:false,
                emplistLoading: false,  //職員番号ローディング用動画
                applyStartTime:'',
                applyEndTime:'',
                showWeekHistory: false,
                value2:{"applyStart":'',"applyEnd":'',applyList:Array(7).fill().map((e,index)=>({"workFlag":index,"workDivisionId":'TMG_WORK|000',"startTime":'',"endTime":'',"restStartTime":'',"restEndTime":''}))},
                wokertypename:'',
                workDivisionList:[],
                columns2: [
                    {
                        title: '曜日',
                        key: 'intDay',
                        width: 50,
                        align: 'center'
                    },
                    {
                        title: '区分',
                        minWidth: 100,
                        slot: 'workDivision',
                        align: 'center'
                    },
                    {
                        title: '始業',
                        slot: 'startTime',
                        align: 'center'
                    },
                    {
                        title: '終業',
                        slot: 'endTime',
                        align: 'center'
                    },
                    {
                        title: '休憩',
                        minWidth: 150,
                        slot: 'rest',
                        align: 'center'
                    }
                ],
                tableData2: [
                    {intDay:'日'},
                    {intDay: '月'},
                    {intDay: '火'},
                    {intDay: '水'},
                    {intDay: '木'},
                    {intDay: '金'},
                    {intDay: '土'}
                ],
                tableData3:[],
                showWeekHistory: false,
                tableDataUsed: [],
                columnsUsed: [
                    {
                        title: '適用開始日',
                        slot: 'startTime',
                        align: 'center'
                    },
                    {
                        title: '適用終了日',
                        slot: 'endTime',
                        align: 'center'
                    },
                    {
                        title: '登録内容',
                        slot: 'content',
                        width: 120,
                        align: 'center'
                    },
                    {
                        title: '削除',
                        slot: 'action',
                        width: 120,
                        align: 'center'
                    }
                ],
                showWeek: false,
                yyyyMMdd:'',
                pattern:{nclose:"",nopen:"",workId:"",bussinessTripid:"",restList:[]},
                value: [],
                valueMap:[],
                selectDisabled:false,
                workPatternSelected: "TMG_PATTERN|",
                columnsAction: [
                    {
                        title: '区分',
                        slot: 'workDivision',
                        align: 'center'
                    },
                    {
                        title: '出張',
                        slot: 'workFar',
                        align: 'center'
                    },
                    {
                        title: '開始時間',
                        slot: 'startTime',
                        align: 'center'
                    },
                    {
                        title: '終了時間',
                        slot: 'endTime',
                        align: 'center'
                    },
                    {
                        title: '休憩',
                        slot: 'restTime',
                        align: 'center'
                    },
                    {
                        title: '一括適用/クリア',
                        slot: 'option',
                        align: 'center'
                    },
                    {
                        title: 'チェックした日に対し',
                        slot: 'apply',
                        align: 'center'
                    }
                ],
                columnsActionData: [{ JSON: {} }],
                isEditable: false,
                selectScheduleInfo:{},
                selectIkkaInfo:{},
                workPatternList:[],
                kubunnList:[],
                syuccyouList:[],
                paidHolidayVO:{},
                scheduleDataDTOList:[],
                loading: false,             //ローディングアクション-->
                contentScrollTop: 0,
                kanjiName: '',　         　 //選択した職員の氏名
                loginEmployee: '',          //選択した職員の職員番号
                isScroll: false,
                data: [],
                referListObject: {       //組織ツリー共通
                    [[${ TREEVIEW_KEY_ADMIN_TARGET_SECTION }]]: '',
                    [[${ TREEVIEW_KEY_ADMIN_TARGET_EMP }]]: '',
                    [[${ TREEVIEW_KEY_RECORD_DATE }]]: '',
                    [[${ TREEVIEW_KEY_REFRESH_FLG }]]: '',
                    hidSearchItems:'EMPLOYEEID',
                    hidSearchCondition:'BROADMATCH',
                    hidSearchData:'',
                    txtTmgReferListTreeViewRecordDate: '',
                    psSite: Utils.getUrlParam(location.href, 'psSite'),
                    psApp: Utils.getUrlParam(location.href,'psApp'),
                    type: 11
                },
                selectedDeptViewType: 3,
                empDeptLoading: false,  // 組織ツリーloading用
                deptDrawShow: false,    //組織ツリー用
                treeData:[],            //組織ツリー用
                empTreeData: [],        //組織ツリー用
                searchConditionsList: [],//組織ツリー用
                searchTypesList: [],     //組織ツリー用
                deptName: '選んでください',   //選択した職員の所属
                query: {
                    EmployeeCode:'',
                    twp_nid:'',
                    psSite: Utils.getUrlParam(location.href, 'psSite'),
                    psApp: Utils.getUrlParam(location.href,'psApp'),
                    txtBaseDate:'',
                    txtEndDate:'',
                    content:{},

                    //
                    sectionid:'',
                    groupid:'',
                    baseDate:'',
                    custId:'',
                    compId:'',
                    language:'',
                },
            }
        },
        async mounted() {
            console.log([[${ session }]])
            this.getOrgTree()
            this.getSearchCondition()
            this.tableData3 = Array(7).fill().map((e,index)=>({"intDay":this.tableData2[index].intDay,"workname":'',"twp_copen":'',"twp_cclose":'',"rest":[]}))

        },
        computed: {
            curSelectedWorkPattern() {
                return this.workPatternList.find(e => e.CPATTERNID === this.workPatternSelected)
            },
            tableHeadFixed() {
                if (this.contentScrollTop > 300) return true
                else return false
            },
            columns() {
                let result= [
                    {
                        title: '日',
                        slot: 'intDay',
                        width: 100,
                        align: 'center'
                    },
                    {
                        title: '区分',
                        minWidth: 36,
                        slot: 'workDivision',
                        align: 'center'
                    },
                    {
                        title: '出張',
                        slot: 'workFar',
                        align: 'center'
                    },
                    {
                        title: '勤務予定',
                        align: 'center',
                        children: [
                            {
                                title: '始業',
                                align: 'center',
                                minWidth: 36,
                                slot: 'workStartFinal'
                            },
                            {
                                title: '終業',
                                minWidth: 36,
                                slot: 'workEndFinal',
                                align: 'center'
                            }
                        ]
                    },
                    {
                        title: '休憩',
                        minWidth: 300,
                        className: 'urgent change-line',
                        slot: 'restTimeList',
                        align: 'center'
                    },
                    {
                        title: '申請・命令',
                        minWidth: 70,
                        key: 'tda_cmessage',
                        align: 'center'
                    },
                    {
                        title: 'コメント',
                        minWidth: 70,
                        slot: 'remark',
                        tooltip: true,
                        align: 'center'
                    }
                ]
                if (this.isEditable) {
                    return result.concat({
                        type: 'selection',
                        width: 60,
                        align: 'center'
                    })
                } else {
                    return result
                }
            }
        },
        methods: {
            handleInputChange(i,object,value,el) {
                if(object) {
                    this.hasPassedTimeCheck =   Utils.checkTime(object, value,el)
                }
            },
            handleSelectAll(selection){
                this.valueMap=selection.map(item=> {
                    return item.tda_nmmdd
                })

            },
            handleSelectApply(){
                if(this.valueMap.length==0){
                    this.$Notice.error({
                        title: '注意',
                        desc: 'データを選択してください',
                        duration: 3.5
                    })
                    return
                }
                const that = this
                this.value.forEach(item=>{
                    Object.keys(item).forEach(function(key) {
                        if(key in that.pattern) {
                            item[key]=JSON.parse(JSON.stringify(that.pattern[key]))
                        }
                    })
                })
            },
            handleSelectAll2(status) {
                this.$refs.selection2.selectAll(status)
                if(!status){
                    this.value=JSON.parse(JSON.stringify(this.valuebak))
                }
            },
            handleMinusRest(e, i) {
                e.splice(i, 1)
            },
            handleAddRest(e) {
                e.push({ restOpen: '', restClose: '' })
            },
            handleChangeDivision(e){
                "TMG_WORK|000"==e?this.patternDisabled=true:this.patternDisabled=false
            },
            handleChangeWorkPattern() {
                const handleTime = Vue.filter('handleTime');
                this.columnsActionData[0].JSON= this.curSelectedWorkPattern.JSON


                let nopen=this.columnsActionData[0].JSON.dutyArray.length === 0?'':this.curSelectedWorkPattern.JSON.dutyArray[0].NOPEN
                let nclose=this.columnsActionData[0].JSON.dutyArray.length === 0?'':this.curSelectedWorkPattern.JSON.dutyArray[0].NCLOSE

                let restList=this.columnsActionData[0].JSON.restArray.map(item=>{
                    return {
                        restOpen:handleTime(item.NOPEN),
                        restClose:handleTime(item.NCLOSE)
                    }
                })
                this.pattern.nopen=handleTime(nopen)
                this.pattern.nclose=handleTime(nclose)
                this.pattern.restList=restList

            },
            async handleClickLeaf(e) {
                //同一部署を二回目でクリックすると、取消とするためで、エラーあり
                //よって、二回目クリックすると、何もしない
                if(!e[0]) return

                const section = [[${ TREEVIEW_KEY_ADMIN_TARGET_SECTION }]]
                this.referListObject[section] = e[0].secid
                this.deptName = e[0].secnic

                this.getEmpList()
            },
            async getEmpList() {
                try {
                    this.emplistLoading = true
                    //初期化及び前回データをクリアする
                    this.empTreeData = []
                    const { empList, recordDate } = await this.http.get('sys/tree/emplist', this.referListObject)
                    this.empTreeData = Utils.convertTreeData(empList[0].child)
                    this.referListObject.txtTmgReferListTreeViewRecordDate = recordDate
                } catch (error) {
                    return
                } finally {
                    this.emplistLoading = false
                }
            },
            handleClickEmpLeaf(e) {
                //同一部署を二回目でクリックすると、取消とするためで、エラーあり
                //よって、二回目クリックすると、何もしない
                if(!e[0]) return

                this.deptDrawShow = false

                this.loginEmployee = e[0].empid
                this.sectionName = e[0].secnic
                this.query.EmployeeCode = e[0].empid
                this.kanjiName = e[0].empname
                this.selectDisabled = true
                this.wokertypename=e[0].wokertypename

                //
                this.query.sectionid= e[0].secid
                this.query.language='ja'
                this.query.groupid='null'
                this.query.baseDate=Utils.formatDate(Date.now(),'YYYY/MM/DD')
                this.query.custId=e[0].cust
                this.query.compId=e[0].comp


                this.getSelectScheduleInfo()
                this.getSelectIkkaInfo()
                this.selectWeekPtn()
                this.selectTmgWeekPatternList()

            },
            async getSelectScheduleInfo() {
                const handleTime = Vue.filter('handleTime');
                this.loading=true
                try {
                    const { data } =  await this.http.get(`sys/schedule/selectScheduleInfo`, this.query)
                    //let data={"period":"2020年05月01日～2020年05月31日","preStart":"2020/04/01","preEnd":"2020/04/30","nextStart":"2020/06/01","nextEnd":"2020/06/30","paidHolidayVO":{"nationalHolidayDays":"13","dateOfRecordDays":"18","dateOfRecord":"139時間30分","npaidRestDaysHour":"38日1時30分"},"scheduleDataDTOList":[{"tda_nmmdd":"01","tda_nmmday":"金","tda_cworkingid_mm":"休職（有給）","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|801","tda_ccustomerid":"2020/05/01","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|03","tda_cbusinesstripid_mm":"出張(移動日)","tda_ccomment_p":"11111","tda_dmmdd":"05/01","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"02","tda_nmmday":"土","tda_cworkingid_mm":"休職（有給）","tda_nopen_p":"8:30","tda_nclose_p":"16:15","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|801","tda_ccustomerid":"2020/05/02","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|03","tda_cbusinesstripid_mm":"出張(移動日)","tda_ccomment_p":"11111","tda_dmmdd":"05/02","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|3"},{"tda_nmmdd":"03","tda_nmmday":"日","tda_cworkingid_mm":"休職（有給）","tda_nopen_p":"8:30","tda_nclose_p":"16:15","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|801","tda_ccustomerid":"2020/05/03","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|03","tda_cbusinesstripid_mm":"出張(移動日)","tda_ccomment_p":"11111","tda_dmmdd":"05/03","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|1"},{"tda_nmmdd":"04","tda_nmmday":"月","tda_cworkingid_mm":"休職（有給）","tda_nopen_p":" ","tda_nclose_p":"16:15","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|801","tda_ccustomerid":"2020/05/04","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|03","tda_cbusinesstripid_mm":"出張(移動日)","tda_ccomment_p":"11111","tda_dmmdd":"05/04","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|2"},{"tda_nmmdd":"05","tda_nmmday":"火","tda_cworkingid_mm":"所定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|570","tda_ccustomerid":"2020/05/05","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/05","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|2"},{"tda_nmmdd":"06","tda_nmmday":"水","tda_cworkingid_mm":"所定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|570","tda_ccustomerid":"2020/05/06","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/06","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|2"},{"tda_nmmdd":"07","tda_nmmday":"木","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/07","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/07","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"08","tda_nmmday":"金","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/08","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/08","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"09","tda_nmmday":"土","tda_cworkingid_mm":"所定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|570","tda_ccustomerid":"2020/05/09","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/09","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|3"},{"tda_nmmdd":"10","tda_nmmday":"日","tda_cworkingid_mm":"法定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|500","tda_ccustomerid":"2020/05/10","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/10","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|1"},{"tda_nmmdd":"11","tda_nmmday":"月","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/11","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/11","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"12","tda_nmmday":"火","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/12","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/12","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"13","tda_nmmday":"水","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/13","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/13","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"14","tda_nmmday":"木","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/14","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/14","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"15","tda_nmmday":"金","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/15","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/15","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"16","tda_nmmday":"土","tda_cworkingid_mm":"所定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|570","tda_ccustomerid":"2020/05/16","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/16","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|3"},{"tda_nmmdd":"17","tda_nmmday":"日","tda_cworkingid_mm":"法定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|500","tda_ccustomerid":"2020/05/17","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/17","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|1"},{"tda_nmmdd":"18","tda_nmmday":"月","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/18","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/18","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"19","tda_nmmday":"火","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/19","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/19","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"20","tda_nmmday":"水","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/20","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/20","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"21","tda_nmmday":"木","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/21","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/21","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"22","tda_nmmday":"金","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/22","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/22","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"23","tda_nmmday":"土","tda_cworkingid_mm":"所定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|570","tda_ccustomerid":"2020/05/23","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/23","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|3"},{"tda_nmmdd":"24","tda_nmmday":"日","tda_cworkingid_mm":"法定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|500","tda_ccustomerid":"2020/05/24","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/24","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|1"},{"tda_nmmdd":"25","tda_nmmday":"月","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/25","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/25","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"26","tda_nmmday":"火","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/26","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/26","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"27","tda_nmmday":"水","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/27","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/27","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"28","tda_nmmday":"木","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/28","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/28","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"29","tda_nmmday":"金","tda_cworkingid_mm":"出勤","tda_nopen_p":"9:30","tda_nclose_p":"18:00","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|000","tda_ccustomerid":"2020/05/29","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/29","avgworktime":"465","mgd_csparechar4":"0","timerange_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"","CID":"TMG_ITEMS|PlanRest"}],"timerange":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"}]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|0"},{"tda_nmmdd":"30","tda_nmmday":"土","tda_cworkingid_mm":"所定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|570","tda_ccustomerid":"2020/05/30","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/30","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|3"},{"tda_nmmdd":"31","tda_nmmday":"日","tda_cworkingid_mm":"法定休","tda_nopen_p":" ","tda_nclose_p":" ","tda_nrestopen_p":null,"tda_nrestclose_p":null,"tda_cmessage":" ","tda_nlock_p":0,"tda_cworkingid_p":"TMG_WORK|500","tda_ccustomerid":"2020/05/31","tda_cstatusflg":null,"tda_cbusinesstripid_p":"TMG_BUSINESS_TRIP|00","tda_cbusinesstripid_mm":"なし","tda_ccomment_p":null,"tda_dmmdd":"05/31","avgworktime":"465","mgd_csparechar4":"1","timerange_arr":[],"timerange":"[]","duty":null,"astem_cworktypeid":"TMG_WORKERTYPE|03","json_arr":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"},{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"json":"[{\"CID\":\"TMG_ITEMS|PlanRest\",\"CTYPE\":\"REJECT\",\"NOPEN\":\"720\",\"NCLOSE\":\"765\"},{\"CID\":\"TMG_ITEMS|PlanDuty\",\"CTYPE\":\"PLAN\",\"NOPEN\":\"570\",\"NCLOSE\":\"1080\"}]","holflgCalendar":"TMG_HOLFLG|1"}]}

                    this.selectScheduleInfo=data
                    this.paidHolidayVO=this.selectScheduleInfo.paidHolidayVO
                    this.scheduleDataDTOList=this.selectScheduleInfo.scheduleDataDTOList
                    this.yyyyMMdd=this.selectScheduleInfo.period
                    this.value=this.scheduleDataDTOList.map(item=>{
                        let restList=item.timerange_arr.map(r=>{
                            return {
                                restClose:handleTime(r.NCLOSE),
                                restOpen:handleTime(r.NOPEN)
                            }
                        })
                        return {
                            "workId":item.tda_cworkingid_p,
                            "bussinessTripid":item.tda_cbusinesstripid_p,
                            "nclose":item.tda_nclose_p,
                            "dyyyymmdd":item.tda_ccustomerid,
                            "nopen":item.tda_nopen_p,
                            "comment":item.tda_ccomment_p,
                            "restList":restList
                        }
                    })
                    this.valuebak=JSON.parse(JSON.stringify(this.value))
                } catch (error) {
                    return
                } finally {
                    this.loading = false
                }
            },
            async selectTmgWeekPatternList(){
                const { data } = await this.http.get(`sys/schedule/selectTmgWeekPatternList`, this.query)
                //let data=[{"twp_dstartdate":"2020/08/01","twp_denddate":"2020/08/31","twp_nid":"763"}]
                this.tableDataUsed=data
            },
            async selectWeekPtn(){
                const { data } = await this.http.get(`sys/schedule/selectWeekPtn`, this.query)
                //let data=[{"mgd_work":"TMG_WORK|000","mgd_workname":"出勤"},{"mgd_work":"TMG_WORK|500","mgd_workname":"法定休"},{"mgd_work":"TMG_WORK|570","mgd_workname":"所定休"},{"mgd_work":"TMG_WORK|480","mgd_workname":"勤務を要しない日"}]
                this.workDivisionList=data
            },
            async selectWeekPatternInfo(i){
                this.weekPatternloading = true
                try{
                        this.query.twp_nid= this.tableDataUsed[i].twp_nid
                        const { data } = await this.http.get(`sys/schedule/selectWeekPatternInfo`, this.query)
                        this.applyStartTime=data.twp_dstartdate
                        this.applyEndTime=data.twp_denddate
                        let index=-1;
                        Object.keys(data).map(e=>{
                            if(e.startsWith("workname")){
                                index++
                                this.tableData3[index].workname=data[e]
                            }
                            if(e.startsWith("twp_copen")){
                                this.tableData3[index].twp_copen=data[e]
                            }
                            if(e.startsWith("twp_cclose")){
                                this.tableData3[index].twp_cclose=data[e]
                            }
                            if(e.startsWith("rest")){
                                this.tableData3[index].rest=data[e].split('-')
                            }

                        })
                    }catch (error) {
                        return
                    }finally {
                        this.weekPatternloading = false
                    }
            },
            async deleteWeekPtn(index){
                this.query.twp_nid= this.tableDataUsed[index].twp_nid
                const { data } = await this.http.get(`sys/schedule/deleteWeekPtn`, this.query)
                this.tableDataUsed.splice(index,1)
            },
            async executeMakeWeekPattern(){
                this.query.content=JSON.stringify(this.value2)
                await this.http.postForm(`sys/schedule/executeMakeWeekPattern`,this.query)
                this.$Message.success('登録完了')
            },
            async postExecuteEditMonthlyUSchedule(){
                if(this.valueMap.length==0){
                    this.$Notice.error({
                        title: '注意',
                        desc: 'データを選択してください',
                        duration: 3.5
                    })
                    return
                }
                let postValue=this.valueMap.map(Number).map(i=>this.value[--i])
                let txtBaseDate= this.yyyyMMdd.split('～')[0].replace(/(.+?)\年(.+?)\月(.+)\日/,"$1/$2/$3")
                let txtEndDate=this.yyyyMMdd.split('～')[1].replace(/(.+?)\年(.+?)\月(.+)\日/,"$1/$2/$3")

                let content={
                    monthlyScheduleEmpInfoDTOS:postValue,
                    endDispDate:txtBaseDate,
                    baseDate:txtEndDate,
                    dispStartDate:Utils.formatDate(Date.now(),'YYYY/MM/DD'),
                    targetUserId:this.loginEmployee,
                    loginUserId: [[${ session.psSession.loginEmployee }]]
                }
                this.query.txtBaseDate=txtBaseDate
                this.query.txtEndDate=txtEndDate
                this.query.content=JSON.stringify(content)
                await this.http.postForm(`sys/schedule/executeEditMonthlyUSchedule`,this.query)
                this.$Message.success('登録完了')

            },
            async getSelectIkkaInfo() {
                    const { data } = await this.http.get(`sys/schedule/selectIkkaInfo`, this.query)
                    //let data={"workPatternList":[{"CPATTERNID":"TMG_PATTERN|","CPATTERNNAME":"(変更しない)","JSON":{"dutyArray":[],"restArray":[]}},{"CPATTERNID":"TMG_PATTERN|08301300","CPATTERNNAME":"(4.50)_08:30-13:00","JSON":{"dutyArray":[{"NCLOSE":"780","NOPEN":"510","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[]}},{"CPATTERNID":"TMG_PATTERN|08301600","CPATTERNNAME":"(6.75)_08:30-16:00","JSON":{"dutyArray":[{"NCLOSE":"960","NOPEN":"510","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|08301615","CPATTERNNAME":"(7.00)_08:30-16:15","JSON":{"dutyArray":[{"NCLOSE":"975","NOPEN":"510","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|08301630","CPATTERNNAME":"(7.25)_08:30-16:30","JSON":{"dutyArray":[{"NCLOSE":"990","NOPEN":"510","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|08301645","CPATTERNNAME":"(7.50)_08:30-16:45","JSON":{"dutyArray":[{"NCLOSE":"1005","NOPEN":"510","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|08301700","CPATTERNNAME":"(7:75)_08:30-17:00","JSON":{"dutyArray":[{"NCLOSE":"1020","NOPEN":"510","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|08301715","CPATTERNNAME":"(8.00)_08:30-17:15","JSON":{"dutyArray":[{"NCLOSE":"1035","NOPEN":"510","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|08451700","CPATTERNNAME":"(7.50)_08:45-17:00","JSON":{"dutyArray":[{"NCLOSE":"1020","NOPEN":"525","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001200","CPATTERNNAME":"(3.00)_09:00-12:00","JSON":{"dutyArray":[{"NCLOSE":"720","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[]}},{"CPATTERNID":"TMG_PATTERN|09001300","CPATTERNNAME":"(4.00)_09:00-13:00","JSON":{"dutyArray":[{"NCLOSE":"780","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[]}},{"CPATTERNID":"TMG_PATTERN|09001330","CPATTERNNAME":"(3.75)_09:00-13:30","JSON":{"dutyArray":[{"NCLOSE":"810","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001400","CPATTERNNAME":"(4.25)_09:00-14:00","JSON":{"dutyArray":[{"NCLOSE":"840","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001445","CPATTERNNAME":"(5.00)_09:00-14:45","JSON":{"dutyArray":[{"NCLOSE":"885","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001500","CPATTERNNAME":"(5.25)_09:00-15:00","JSON":{"dutyArray":[{"NCLOSE":"900","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001545","CPATTERNNAME":"(6.00)_09:00-15:45","JSON":{"dutyArray":[{"NCLOSE":"945","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001600","CPATTERNNAME":"(6.25)_09:00-16:00","JSON":{"dutyArray":[{"NCLOSE":"960","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001630","CPATTERNNAME":"(6.75)_09:00-16:30","JSON":{"dutyArray":[{"NCLOSE":"990","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001645","CPATTERNNAME":"(7.00)_09:00-16:45","JSON":{"dutyArray":[{"NCLOSE":"1005","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001700","CPATTERNNAME":"(7.25)_09:00-17:00","JSON":{"dutyArray":[{"NCLOSE":"1020","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001715","CPATTERNNAME":"(7.50)_09:00-17:15","JSON":{"dutyArray":[{"NCLOSE":"1035","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09001730","CPATTERNNAME":"(7.75)_09:00-17:30","JSON":{"dutyArray":[{"NCLOSE":"1050","NOPEN":"540","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09151215","CPATTERNNAME":"(3.00)_09:15-12:45","JSON":{"dutyArray":[{"NCLOSE":"765","NOPEN":"555","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[]}},{"CPATTERNID":"TMG_PATTERN|09151400","CPATTERNNAME":"(4.00)_09:15-14:00","JSON":{"dutyArray":[{"NCLOSE":"840","NOPEN":"555","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09151500","CPATTERNNAME":"(5.00)_09:15-15:00","JSON":{"dutyArray":[{"NCLOSE":"900","NOPEN":"555","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09151600","CPATTERNNAME":"(6.00)_09:15-1600","JSON":{"dutyArray":[{"NCLOSE":"960","NOPEN":"555","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09151700","CPATTERNNAME":"(7.00)_09:45-17:00","JSON":{"dutyArray":[{"NCLOSE":"1020","NOPEN":"585","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09301230","CPATTERNNAME":"(3.00)_09:30-12:30","JSON":{"dutyArray":[{"NCLOSE":"750","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[]}},{"CPATTERNID":"TMG_PATTERN|09301515","CPATTERNNAME":"(5.00)_09:30-15:15","JSON":{"dutyArray":[{"NCLOSE":"915","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09301615","CPATTERNNAME":"(6.00)_09:30-16:15","JSON":{"dutyArray":[{"NCLOSE":"975","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09301700","CPATTERNNAME":"(6.75)_09:30-17:00","JSON":{"dutyArray":[{"NCLOSE":"1020","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09301715","CPATTERNNAME":"(7.00)_09:30-17:15","JSON":{"dutyArray":[{"NCLOSE":"1035","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09301745","CPATTERNNAME":"(7.50)_09:30-17:45","JSON":{"dutyArray":[{"NCLOSE":"1065","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09301800","CPATTERNNAME":"(7.75)_09:30-18:00","JSON":{"dutyArray":[{"NCLOSE":"1080","NOPEN":"570","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09451630","CPATTERNNAME":"(6.00)_09:45-16:30","JSON":{"dutyArray":[{"NCLOSE":"990","NOPEN":"585","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|09451800","CPATTERNNAME":"(7.50)_09:45-18:00","JSON":{"dutyArray":[{"NCLOSE":"1080","NOPEN":"585","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|10001445","CPATTERNNAME":"(4.00)_10:00-14:45","JSON":{"dutyArray":[{"NCLOSE":"885","NOPEN":"600","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|10001545","CPATTERNNAME":"(5.00)_10:00-15:45","JSON":{"dutyArray":[{"NCLOSE":"945","NOPEN":"600","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|10001645","CPATTERNNAME":"(6.00)_10:00-16:45","JSON":{"dutyArray":[{"NCLOSE":"1005","NOPEN":"600","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|10001745","CPATTERNNAME":"(7.00)_10:00-17:45","JSON":{"dutyArray":[{"NCLOSE":"1065","NOPEN":"600","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|10151800","CPATTERNNAME":"(7.00)_10:15-18:00","JSON":{"dutyArray":[{"NCLOSE":"1080","NOPEN":"615","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|10451630","CPATTERNNAME":"(5.00)_10:45-16:30","JSON":{"dutyArray":[{"NCLOSE":"990","NOPEN":"645","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|11001645","CPATTERNNAME":"(5.00)_11:00-16:45","JSON":{"dutyArray":[{"NCLOSE":"1005","NOPEN":"660","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[{"NCLOSE":"765","NOPEN":"720","CTYPE":"REJECT","CID":"TMG_ITEMS|PlanRest"}]}},{"CPATTERNID":"TMG_PATTERN|12451645","CPATTERNNAME":"(4.00)_12:45-16:45","JSON":{"dutyArray":[{"NCLOSE":"1005","NOPEN":"765","CTYPE":"PLAN","CID":"TMG_ITEMS|PlanDuty"}],"restArray":[]}}],"kubunnList":[{"MGD_CMASTERCODE":"TMG_WORK|000","MGD_CGENERICDETAILDESC":"出勤"},{"MGD_CMASTERCODE":"TMG_WORK|480","MGD_CGENERICDETAILDESC":"勤務を要しない日"},{"MGD_CMASTERCODE":"TMG_WORK|500","MGD_CGENERICDETAILDESC":"法定休"},{"MGD_CMASTERCODE":"TMG_WORK|570","MGD_CGENERICDETAILDESC":"所定休"},{"MGD_CMASTERCODE":"TMG_WORK|800","MGD_CGENERICDETAILDESC":"休職（無給）"},{"MGD_CMASTERCODE":"TMG_WORK|801","MGD_CGENERICDETAILDESC":"休職（有給）"},{"MGD_CMASTERCODE":"TMG_WORK|805","MGD_CGENERICDETAILDESC":"停職"},{"MGD_CMASTERCODE":"TMG_WORK|810","MGD_CGENERICDETAILDESC":"育児休業"},{"MGD_CMASTERCODE":"TMG_WORK|811","MGD_CGENERICDETAILDESC":"介護休業"},{"MGD_CMASTERCODE":"TMG_WORK|820","MGD_CGENERICDETAILDESC":"自己啓発休業"}],"syuccyouList":[{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|00","MGD_CGENERICDETAILDESC":"なし"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|01","MGD_CGENERICDETAILDESC":"出張(国内)"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|02","MGD_CGENERICDETAILDESC":"出張(海外)"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|03","MGD_CGENERICDETAILDESC":"出張(移動日)"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|04","MGD_CGENERICDETAILDESC":"研修"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|05","MGD_CGENERICDETAILDESC":"講習"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|06","MGD_CGENERICDETAILDESC":"留学(国内)"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|07","MGD_CGENERICDETAILDESC":"留学(海外)"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|08","MGD_CGENERICDETAILDESC":"外勤"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|09","MGD_CGENERICDETAILDESC":"職場外(部署外)勤務"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|10","MGD_CGENERICDETAILDESC":"赴任"},{"MGD_CMASTERCODE":"TMG_BUSINESS_TRIP|11","MGD_CGENERICDETAILDESC":"帰住"}]}
                    this.selectIkkaInfo=data
                    this.workPatternList=this.selectIkkaInfo.workPatternList
                    this.kubunnList=this.selectIkkaInfo.kubunnList
                    this.syuccyouList=this.selectIkkaInfo.syuccyouList
            },
            async getOrgTree() {
                try {
                    const { orgList, recordDate } = await this.http.get('sys/tree', this.referListObject)
                    this.treeData = Utils.convertTreeData(orgList)
                    this.referListObject.txtTmgReferListTreeViewRecordDate = recordDate
                } catch (error) {
                    return
                } finally {
                    this.loading = false
                }
            },
            async getSearchCondition() {
                const { data } = await this.http.get('sys/tree/conditions', this.referListObject)
                this.searchConditionsList= Object.keys(data.searchConditions).map(e=> { return { name:data.searchConditions[e], value:e }})
                this.searchTypesList = Object.keys(data.searchTypes).map(e=> { return { name:data.searchTypes[e], value:e }})
            },
            async handleDeptDateChange(e) {
                this.referListObject.txtTmgReferListTreeViewRecordDate = e
                this.isSearchHistory = true
                await this.getOrgTree()
                this.$Notice.warning({ title:'所属図更新完了',desc:"下記の所属リストから対象を選んでください" })
            },
            searchOrgTree: Debounce( async function() {
                this.empDeptLoading = true
                try {
                    const { data } = await this.http.get('sys/tree/search', this.referListObject)
                    this.treeData = Utils.convertTreeData(data)
                    this.$Notice.success({ title:'所属図更新完了' })
                } catch (error) {
                    return
                } finally {
                    this.empDeptLoading = false
                }
            }),
            handleScroll: Throttle(function(e) {
                this.contentScrollTop = e.target.scrollTop
                if (e.target.scrollTop > 200) {
                    this.isScroll = true
                } else {
                    this.isScroll = false
                }
            }, 50),
            dayRed(e) {
                if (!e) {
                    return
                }
                if (e.indexOf('土') > -1 || e.indexOf('日') > -1) {
                    return 'rest-cell week-rest'
                }
                if (e.indexOf('休') > -1) {
                    return 'rest-cell year-rest'
                }
                return 'rest-cell'
            },
            async preMonth() {
                this.query.txtBaseDate=this.selectScheduleInfo.preStart
                this.query.txtEndDate=this.selectScheduleInfo.preEnd
                await this.getSelectScheduleInfo()
                await this.getSelectIkkaInfo()
            },
            async nextMonth() {
                this.query.txtBaseDate=this.selectScheduleInfo.nextStart
                this.query.txtEndDate=this.selectScheduleInfo.nextEnd
                await this.getSelectScheduleInfo()
                await this.getSelectIkkaInfo()
            },
            rowClass(row) {
                // 表格变色
                if (!row.dayDivisionCode || row.dayDivisionCode === '1') {
                    return ''
                }
                return 'sat'
            },
            toTop() {
                const animateMachine = requestAnimationFrame(this.toTop)
                this.$refs.layout.scrollTop = this.$refs.layout.scrollTop - this.$refs.layout.scrollTop / 5
                if (this.$refs.layout.scrollTop === 0) {
                    cancelAnimationFrame(animateMachine)
                }
            },

        }
    })
</script>
</body>

</html>