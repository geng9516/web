!function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}({4:function(t,e){function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e,r,n,s,i,a){try{var o=t[i](a),p=o.value}catch(t){return void r(t)}o.done?e(p):Promise.resolve(p).then(n,s)}function p(t){return function(){var e=this,r=arguments;return new Promise((function(n,s){var i=t.apply(e,r);function a(t){o(i,n,s,a,p,"next",t)}function p(t){o(i,n,s,a,p,"throw",t)}a(void 0)}))}}new Vue({el:".restApply-warp",data:function(){return{hasPassedTimeCheck:!0,week:[{name:"月",value:1},{name:"火",value:2},{name:"水",value:3},{name:"木",value:4},{name:"金",value:5},{name:"土",value:6},{name:"日",value:7}],curYear:(new Date).getFullYear(),restInfoList:[],statusList:[],timerangeType:1,loading:!1,moreDataLoading:!1,rotate:!1,restInfoLoading:!1,listLoading:!1,applyHistoryListData:[],opts:{ntfTypeId:"",statusFlg:0,year:2020,psSite:Utils.getUrlParam(location.href,"psSite"),page:1},restApply:{useVacation:!1,weekSelected:[],noreserved:1,dateList:"",dateListRange:["",""],txtAddDate:null,txtTargetNumber:null},applyHistoryListAmount:0,restTypeListForReview:[],restTypeListForApply:[],selectedRestInfo:{},uploadFiles:[],deleteFiles:[],cacelBtnLoading:[],isReApplyIng:!1}},watch:{"restApply.noreserved":function(t){if(1===t)return this.restApply.weekSelected=[]},rotate:function(t){if(!t)return this.opts.ntfTypeId="",!this.isReApplyIng&&this.$refs.select?this.$refs.select.clearSingleSelect():void 0;this.restApply.restTypeId="全て"}},created:function(){this.getRestTypeForApply(),this.getRestTypeForReview(),this.getRestInfo(),this.getStatusList(),this.getApplyHistory(!0)},mounted:function(){},computed:{handleFrontCardClass:function(){var t="card";this.rotate&&(t=t.concat(" rotate-180"));var e=this.selectedRestInfo.ntfName;return e&&e.length>25&&(t=t.concat(" full-name")),t},curRestTypeList:function(){return this.rotate?this.restTypeListForReview:this.restTypeListForApply}},methods:{showDatePicker:function(t,e){var r=this;this.datePicker||(this.datePicker=cube.dPicker.$create({title:"日付",min:new Date("".concat((new Date).getFullYear()-20,"/1/1")),max:new Date("".concat((new Date).getFullYear()+30,"/12/31")),value:new Date,zIndex:900}),this.datePicker.$on("select",(function(n){"number"==typeof e?r.$set(r.restApply[t],e,Utils.formatDate(n,"yyyy/MM/dd")):r.$set(r.restApply,t,Utils.formatDate(n,"yyyy/MM/dd")),r.datePicker.remove(),r.datePicker=null}))),this.datePicker.show()},showYearSelector:function(t){var e=this;if(!this.yearSelector){var r=Utils.getNumArray(1970,2100).findIndex((function(t){return t===e.curYear}));console.log(r);var n=Utils.getNumArray(1970,2100).map((function(t){return{value:t,text:t}}));this.yearSelector=cube.picker.$create({title:"年",selectedIndex:[r],data:[n],zIndex:900}),this.yearSelector.$on("select",(function(t){e.opts.year=t[0],e.curYear=t[0],e.getApplyHistory(),e.yearSelector.remove(),e.yearSelector=null}))}this.yearSelector.show()},getRestTypeForApply:function(){var t=this;return p(regeneratorRuntime.mark((function e(){var r,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,t.http.get("sys/vapply/NtfTypeList",t.opts);case 4:r=e.sent,s=r.data,a=[],s.forEach((function(t){var e;a=(e=a).concat.apply(e,i(t.ntfTypeValue.map((function(t){return n(n({},t),{},{value:t.ntfId,text:t.ntfName})}))))})),t.restTypeListForApply=a,e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return");case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))()},getRestTypeForReview:function(){var t=this;return p(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,t.http.get("sys/vapply/NtfTypeDispList",t.opts);case 4:r=e.sent,n=r.data,t.restTypeListForReview=n,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return");case 12:return e.prev=12,t.loading=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})))()},getRestInfo:function(){var t=this;return p(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.restInfoLoading=!0,e.prev=1,e.next=4,t.http.get("sys/vapply/RestYearList",t.opts);case 4:r=e.sent,n=r.data,t.restInfoList=n,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return");case 12:return e.prev=12,t.restInfoLoading=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})))()},getStatusList:function(){var t=this;return p(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.http.get("sys/vapply/StatusFlg",t.opts);case 2:r=e.sent,n=r.data,t.statusList=[{value:0,text:"全て"}].concat(n.map((function(t){return{value:t.stutasId,text:t.stutasName}})));case 5:case"end":return e.stop()}}),e)})))()},getApplyHistory:Debounce(function(){var t=p(regeneratorRuntime.mark((function t(e){var r,s,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.listLoading=!0,this.opts.page=1,t.prev=2,r=n({},this.opts),0===this.opts.statusFlg&&(r.statusFlg=""),t.next=7,this.http.get("sys/vapply/NotificationList",r);case 7:s=t.sent,i=s.data,this.applyHistoryListData=i.list,this.applyHistoryListAmount=i.totalCount,e||this.$Message.success("再表示完了"),t.next=17;break;case 14:return t.prev=14,t.t0=t.catch(2),t.abrupt("return");case 17:return t.prev=17,this.loading=!1,this.listLoading=!1,t.finish(17);case 21:case"end":return t.stop()}}),t,this,[[2,14,17,21]])})));return function(e){return t.apply(this,arguments)}}()),handleWeekSelect:function(t){},handleRestType:function(t){if(t){if(this.rotate)return this.opts.ntfTypeId="全て"===t?"":t,void this.getApplyHistory();this.restApply={useVacation:!1,weekSelected:[],noreserved:1,dateList:"",dateListRange:["",""],txtAddDate:null,txtTargetNumber:null},this.errorInfo=!1,this.uploadFiles=[],this.hasPassedTimeCheck=!0,this.selectedRestInfo={},"全て"!==t?(this.restApply.restTypeId=t,this.isReApplyIng=!1,this.selectedRestInfo=this.restTypeListForApply.find((function(e){return e.ntfId===t}))):this.restApply.restTypeId="全て"}},onRefresh:function(){this.rotate=!this.rotate},cancel:Debounce(function(){var t=p(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.$set(this.cacelBtnLoading,r,!0),t.prev=1,t.next=4,this.http.post("sys/vapply/EditWithdrop",{action:"ACT_EditApply_UWithdraw",ntfNo:e.tntfCntfNo,psSite:this.opts.psSite});case 4:this.$Message.success("取り消し完了"),t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return");case 10:return t.prev=10,this.$set(this.cacelBtnLoading,r,!1),this.getApplyHistory(),t.finish(10);case 14:case"end":return t.stop()}}),t,this,[[1,7,10,14]])})));return function(e,r){return t.apply(this,arguments)}}(),700),handleHistoryStatusChange:function(t){this.getApplyHistory()},apply:Debounce(function(){var t=p(regeneratorRuntime.mark((function t(e){var r,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.restApply.action="ACT_MakeApply_CAppl",e&&(this.restApply.action="ACT_ReMakeApply_CAppl"),this.restApply.typeNew=this.selectedRestInfo.ntfId,this.restApply.finalApprovalLevel=this.selectedRestInfo.finalApprovalLevel5,this.restApply.weekSelectedHelper=this.restApply.weekSelected.join(),["mon","tue","wed","thu","fri","sat","sun"].forEach((function(t,e){n.restApply.weekSelectedHelper.indexOf("".concat(e+1))>-1?n.restApply[t]="1":n.restApply[t]="0"})),this.selectedRestInfo.transfer||(2===this.timerangeType&&(this.restApply.begin=this.restApply.dateListRange[0],this.restApply.end=this.restApply.dateListRange[1]),1===this.timerangeType&&(this.restApply.begin=this.restApply.dateList,this.restApply.end=this.restApply.dateList)),this.restApply.typeNew){t.next=10;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"申請区分を選んでください",duration:6.5}));case 10:if("0"==this.selectedRestInfo.confirmComment||this.restApply.owncomment){t.next=12;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"申請事由を入力してください",duration:6.5}));case 12:if(this.restApply.begin&&this.restApply.end){t.next=14;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"期間を選んでください",duration:6.5}));case 14:if(!this.restApply.begin&&!this.restApply.end){t.next=21;break}if(!this.restApply.begin||this.restApply.end){t.next=17;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"開始期間を入力してください",duration:6.5}));case 17:if(this.restApply.begin||!this.restApply.end){t.next=19;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"終了期間を入力してください",duration:6.5}));case 19:if(!(!this.selectedRestInfo.transfer&&this.restApply.begin&&this.restApply.end&&Utils.timeToMinute(this.restApply.begin)>Utils.timeToMinute(this.restApply.end))){t.next=21;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"開始期間 ＜ 終了期間となるようにしてください",duration:6.5}));case 21:if(!this.selectedRestInfo.timeZone){t.next=34;break}if(this.restApply.timezoneOpen){t.next=26;break}return this.errorInfo=!0,this.errorMsg="開始時間を入力してください",t.abrupt("return");case 26:if(this.restApply.timezoneClose){t.next=30;break}return this.errorInfo=!0,this.errorMsg="終了時間を入力してください",t.abrupt("return");case 30:if(!(!this.selectedRestInfo.transfer&&this.restApply.timezoneOpen&&this.restApply.timezoneOpen&&Utils.timeToMinute(this.restApply.timezoneOpen)>=Utils.timeToMinute(this.restApply.timezoneClose))){t.next=34;break}return this.errorInfo=!0,this.errorMsg="開始時間 ＜ 終了時間となるようにしてください",t.abrupt("return");case 34:if(this.hasPassedTimeCheck){t.next=36;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"時刻をHH:MM形式で入力してください",duration:6.5}));case 36:if(!this.selectedRestInfo.workTime){t.next=41;break}if(this.restApply.timeOpen){t.next=39;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"始業後時刻を入力してください",duration:6.5}));case 39:if(this.restApply.timeClose){t.next=41;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"終業前時刻を入力してください",duration:6.5}));case 41:if(!this.selectedRestInfo.period||this.restApply.txtPeriod){t.next=43;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"起算日を入力してください",duration:6.5}));case 43:if(!this.selectedRestInfo.name||this.restApply.txtName){t.next=45;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"氏名を入力してください",duration:6.5}));case 45:if(!this.selectedRestInfo.relation||this.restApply.txtRelation){t.next=47;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"続柄を入力してください",duration:6.5}));case 47:if(!this.selectedRestInfo.targetNumber||this.restApply.txtTargetNumber){t.next=49;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"対象の人数を入力してください",duration:6.5}));case 49:if(!this.selectedRestInfo.birthday||this.restApply.txtBirthday){t.next=51;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"生年月日を入力してください",duration:6.5}));case 51:if(!this.selectedRestInfo.sickName||this.restApply.txtSickName){t.next=53;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"傷病名を入力してください",duration:6.5}));case 53:if("0"==this.selectedRestInfo.confirmComment||this.restApply.owncomment){t.next=55;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"申請事由を入力してください",duration:6.5}));case 55:if(!("1"===this.selectedRestInfo.confirmFile&&!this.uploadFiles.length>0)){t.next=57;break}return t.abrupt("return",this.$Notice.warning({title:"注意",desc:"添付ファイルを入力してください",duration:6.5}));case 57:return this.deleteFiles=i(new Set(this.deleteFiles)),t.prev=58,this.loading=!0,t.next=62,this.http.uploadFiles("sys/vapply/MakeApply",{params:JSON.stringify(this.restApply),uploadFiles:this.uploadFiles.filter((function(t){return!t.isDefault})),deleteFiles:JSON.stringify(this.deleteFiles),psSite:this.opts.psSite});case 62:return this.restApply={useVacation:!1,restTypeId:"全て",weekSelected:[],noreserved:1,dateList:"",dateListRange:["",""],txtAddDate:null,txtTargetNumber:null},this.rotate=!this.rotate,this.isReApplyIng=!1,t.next=67,this.getApplyHistory(!0);case 67:return t.next=69,this.getRestInfo();case 69:this.$Message.success("申請完了"),this.uploadFiles=[],t.next=79;break;case 73:if(t.prev=73,t.t0=t.catch(58),!(t.t0.config||t.t0.response&&500===t.t0.response.status)){t.next=77;break}return t.abrupt("return");case 77:return r=JSON.parse(t.t0),t.abrupt("return",this.$Modal.error({title:"注意",content:r[Object.keys(r)[0]][0].ERRMSG}));case 79:return t.prev=79,this.loading=!1,this.deleteFiles=[],t.finish(79);case 83:case"end":return t.stop()}}),t,this,[[58,73,79,83]])})));return function(e){return t.apply(this,arguments)}}()),handleApplyMarkShow:function(t){return t.indexOf("0")>-1?"apply-status":t.indexOf("2")>-1?"apply-status ing":t.indexOf("3")>-1?"apply-status deny":t.indexOf("9")>-1?"apply-status error":"apply-status ok"},handleTimelineDotShow:function(t){return t.indexOf("0")>-1?"with-dot cancel":t.indexOf("2")>-1?"with-dot ing":t.indexOf("3")>-1||t.indexOf("9")>-1?"with-dot deny":"with-dot"},handleApplyDayShow:function(t,e){return t===e?t:"".concat(t," ～ ").concat(e)},handleReApplybtn:function(t){var e=this;return p(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.deleteFiles=[],e.uploadFiles=[],e.rotate=!e.rotate,console.log(e.selectedRestInfo.transfer),console.log(t.remakeApply),e.$nextTick((function(){e.handleRestType(t.remakeApply),e.isReApplyIng=!0,e.selectedRestInfo.transfer?(console.log(t.tntfDbegin),console.log(t.tntfDend),e.restApply.begin=t.tntfDbegin,e.restApply.end=t.tntfDend):t.tntfDbegin!==t.tntfDend?(e.timerangeType=2,e.restApply.dateListRange=[t.tntfDbegin,t.tntfDend]):(e.timerangeType=1,e.restApply.dateList=t.tntfDbegin)})),e.restApply.restTypeId=t.remakeApply,e.restApply.ntfNo=t.tntfCntfNo,e.selectedRestInfo.finalApprovalLevel=t.finalApprovalLevel,e.uploadFiles=t.tmgNtfAttachedfileDoList.map((function(t){return{name:t.tnafCfilename,url:t.tnafFilepath,type:t.tnafCfilename,isDefault:!0}})),e.restApply.owncomment=t.tntfCowncomment,r.next=13,e.http.get("sys/vapply/NotificationDetail",{ntfNo:t.tntfCntfNo});case 13:n=r.sent,s=n.data,e.restApply.ntfNo=t.tntfCntfNo,e.restApply.txtPeriod=s.tntfDperiodDate,e.restApply.txtAddDate=s.tntfNuapperAddition,e.$set(e.resetReApply,"timezoneOpen",s.tntfNtimezoneOpenHhmi),e.$set(e.resetReApply,"timezoneClose",s.tntfNtimezoneCloseHhmi),e.restApply.timeOpen=s.tntfNtimeOpen,e.restApply.timeClose=s.tntfNtimeClose,e.restApply.noreserved=s.tntfNnoreserved,e.restApply.weekSelected=[1===s.tntfNmon?1:0,,1===s.tntfNtue?2:0,,1===s.tntfNwed?3:0,,1===s.tntfNthu?4:0,,1===s.tntfNfri?5:0,,1===s.tntfNsat?6:0,,1===s.tntfNsun?7:0],e.restApply.txtName=s.tntfCemployeeidName,e.restApply.txtRelation=s.tntfCrelation,e.restApply.txtTargetNumber=s.tntfNnumberOfTarget,e.restApply.txtBirthday=s.tntfDdateofbirth,e.restApply.txtSickName=s.tntfCsickName;case 29:case"end":return r.stop()}}),r)})))()},resetReApply:function(){this.loading=!0,history.go(0)},handleBeforeUpload:function(t){var e=!0;return this.uploadFiles.length>=5&&(this.$Notice.warning({title:"添付可能なファイル数が上限（5個）を超えました。"}),e=!1),t.size/1024>500&&(this.$Notice.warning({title:"Exceeding file size limit",desc:"ファイル「"+t.name+"」のサイズが上限（500kBytes）を超えました。"}),e=!1),e&&this.uploadFiles.push(t),!1},handleDelFile:function(t){this.deleteFiles.push(t.name),this.uploadFiles=this.uploadFiles.filter((function(e){return e.name!==t.name}))},handleTypeNameShow:function(t){var e=t.tntfCtype;return t.tntfNtimezoneOpen&&(e=e.concat(" (".concat(t.tntfNtimezoneOpen," - ").concat(t.tntfNtimezoneClose,")"))),t.dayOfWeek.indexOf("なし")>-1?e:e=e.concat(" ".concat(t.dayOfWeek))},handleMoreDataLoading:function(){var t=this;return p(regeneratorRuntime.mark((function e(){var r,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.opts.page+=1,t.moreDataLoading=!0,e.prev=2,r=n({},t.opts),0===t.opts.statusFlg&&(r.statusFlg=""),e.next=7,t.http.get("sys/vapply/NotificationList",r);case 7:s=e.sent,i=s.data,t.applyHistoryListData=t.applyHistoryListData.concat(i.list),t.$Message.success("再表示完了"),e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(2),e.abrupt("return");case 16:return e.prev=16,t.moreDataLoading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[2,13,16,19]])})))()},applyCardDownloadFile:function(t){t.url&&window.open("http:////".concat(t.url.slice(2)),"_blank")},handleInputChange:function(t,e,r,n){e&&(this.hasPassedTimeCheck=Utils.checkTime(e,r,n))}}})}});